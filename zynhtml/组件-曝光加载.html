<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>懒加载</title>
    <style>
        ul,li{
            list-style: none;

        }
        .container{
            width:800px;
            margin: 0 auto;
        }
        .container li{
            float:left;
            margin: 10px 10px;
        }
       .container li img {
           width:380px;
          height:380px;
       }
       .clear{
           content:'';
           display: block;
           clear: both;
       }
    </style>
</head>
<body>
    <ul class="container clear">
         <li><a href=""><img src="" data-src="http://img1.imgtn.bdimg.com/it/u=1794894692,1423685501&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img3.imgtn.bdimg.com/it/u=4271053251,2424464488&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img4.imgtn.bdimg.com/it/u=819201812,3553302270&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img5.imgtn.bdimg.com/it/u=4155302816,1201715785&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img4.imgtn.bdimg.com/it/u=1350614941,725003865&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img3.imgtn.bdimg.com/it/u=3771287340,4264471813&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img2.imgtn.bdimg.com/it/u=4126257507,3957500859&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img3.imgtn.bdimg.com/it/u=3843979064,1483327667&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img0.imgtn.bdimg.com/it/u=3232463365,1553586369&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img4.imgtn.bdimg.com/it/u=220980845,3087446489&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img1.imgtn.bdimg.com/it/u=2480825736,542453251&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img2.imgtn.bdimg.com/it/u=1785510636,185861396&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img1.imgtn.bdimg.com/it/u=1794894692,1423685501&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img3.imgtn.bdimg.com/it/u=4271053251,2424464488&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img4.imgtn.bdimg.com/it/u=819201812,3553302270&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img5.imgtn.bdimg.com/it/u=4155302816,1201715785&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img4.imgtn.bdimg.com/it/u=1350614941,725003865&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img3.imgtn.bdimg.com/it/u=3771287340,4264471813&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img2.imgtn.bdimg.com/it/u=4126257507,3957500859&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img3.imgtn.bdimg.com/it/u=3843979064,1483327667&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img0.imgtn.bdimg.com/it/u=3232463365,1553586369&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img4.imgtn.bdimg.com/it/u=220980845,3087446489&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img1.imgtn.bdimg.com/it/u=2480825736,542453251&fm=23&gp=0.jpg" ></a></li>
         <li><a href=""><img src="" data-src="http://img2.imgtn.bdimg.com/it/u=1785510636,185861396&fm=23&gp=0.jpg" ></a></li>
         <p id="hello">Hello</p>
         <p id="world">world</p>
    </ul>
    <script src="jquery-3.2.0.min.js"></script>
    <script>



 function Exposure($target,callback){
     this.$target = $target;
     this.callback = callback;
     this.bind();
     this.check();

 }

//  Exposure.prototype.init = function(){


//  }
//  Exposure.prototype.bind = function(){
//      var _this = this;
//      $(window).on('scroll', function(){
//          _this.check();
//      })

//  }
//  Exposure.prototype.check = function(){
      

//      if(this.isShow(this.$target)){
//           this.callback(this.$target);
//      }
            

//  }
//  Exposure.prototype.isShow = function(){
      
//  var windowHeight = $(window).height(),
//                 scrollTop = $(window).scrollTop(),
//                 offsetTop = this.$target.offset().top,
//                 nodeHeight = this.$target.height();
//             if(windowHeight+scrollTop>offsetTop && scrollTop< offsetTop+nodeHeight){
//                 return true;
//             }else{
//                 return false;
//             }    
  
            

 


//  new Exposure($('#hello'),function($node){
//      setTimeout(function(){
//            $node.text($node.text()+' world');
//      })
    
//  })
//  new Exposure($('#world'),function($node){
//      setTimeout(function(){
//           $node.text('hello '+$node.text());
//      })
    
//  })

// $('.container img').each(function(idx,img){
//      new Exposure($('img'),function($img){
//       showImg($img)
//    })

// })

var Lazy =(function(){
     function Exposure($target,callback){
     this.$target = $target;
     this.callback = callback;
     this.bind();
     this.check();

 }

 Exposure.prototype.showImg = function($node){

     var imgUrl = $node.attr('data-src');
                 $node.attr('src',imgUrl);

 }
 Exposure.prototype.bind = function(){
     var _this = this;
     $(window).on('scroll', function(){
         _this.check();
     })

 }
 Exposure.prototype.check = function(){
      

     if(this.isShow(this.$target)){
          this.callback(this.$target);
     }
            

 }
 Exposure.prototype.isShow = function(){
      
 var windowHeight = $(window).height(),
                scrollTop = $(window).scrollTop(),
                offsetTop = this.$target.offset().top,
                nodeHeight = this.$target.height();
            if(windowHeight+scrollTop>offsetTop && scrollTop< offsetTop+nodeHeight){
                return true;
            }else{
                return false;
            }  
 }  
  
            


    return {
        init :function($targets,callback){
            $targets.each(function(idx,target){
                new Exposure($(target),callback)
            })

        },
        one:function(){}
    }
})()

Lazy.init($('#hello'),function($node){
     $node.text($node.text()+' zyn');
})
Lazy.init($('#world'),function($node){
     $node.text($node.text()+' 123');
})
Lazy.init($('.container img'),function($node){
     this.showImg($node);
})

        // function showImg($img){
            
        //     var imgUrl = $img.attr('data-src');
        //         $img.attr('src',imgUrl);
            
           
        // }











        // check();
        // $(window).on('scroll', check)

        // function  check(){
        //     $('.container img').not('.load').each(function(){
        //         if(isShow($(this))){
        //             show($(this))
        //         }
        //     })
        // } 



        // function show($imgs){
        //     $imgs.each(function(){
        //         var imgUrl = $(this).attr('data-src');
        //         $(this).attr('src',imgUrl);
        //         $(this).addClass('load')
        //     })
        // }


        // function isShow($node){
        //     var windowHeight = $(window).height(),
        //         scrollTop = $(window).scrollTop(),
        //         offsetTop = $node.offset().top,
        //         nodeHeight = $node.height();
        //     if(windowHeight+scrollTop>offsetTop && scrollTop< offsetTop+nodeHeight){
        //         return true;
        //     }else{
        //         return false;
        //     }     //scrollTop< offsetTop+nodeHeight浏览器上边缘
        //          //windowHeight+scrollTop>offsetTop浏览器下边缘
        // }
    </script>
</body>
</html>